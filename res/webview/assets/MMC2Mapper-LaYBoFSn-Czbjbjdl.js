import{t as r}from"./index-C1mDYnUx.js";import{n as e}from"./Mapper-DR43KiVi-C3VBMEhO.js";class n extends e{chrlatchL=!0;chrlatchR=!1;chrbankL1=0;chrbankR1=0;chrbankL2=0;chrbankR2=0;loadROM(){super.loadROM();for(let s=1;s<=32;++s)this.prg_map[32-s]=this.prgsize-1024*s;for(let s=0;s<8;++s)this.chr_map[s]=0}cartWrite(s,t){if(s<32768||s>65535)super.cartWrite(s,t);else if(s>=40960&&s<=45055)for(let h=0;h<8;++h)this.prg_map[h]=1024*(h+8*(15&t))&this.chrsize-1;else s>=45056&&s<=49151?(this.chrbankL1=31&t,this.setupPPUBanks()):s>=49152&&s<=53247?(this.chrbankL2=31&t,this.setupPPUBanks()):s>=53248&&s<=57343?(this.chrbankR1=31&t,this.setupPPUBanks()):s>=57344&&s<=61439?(this.chrbankR2=31&t,this.setupPPUBanks()):s>=61440&&s<=65535&&this.setmirroring(1&t?r.H_MIRROR:r.V_MIRROR)}ppuRead(s){const t=super.ppuRead(s);if(8&s)switch(s>>4){case 253:3&s||(this.chrlatchL=!1,this.setupPPUBanks());break;case 254:if(!(3&s)){this.chrlatchL=!0,this.setupPPUBanks();break}break;case 509:this.chrlatchR=!1,this.setupPPUBanks();break;case 510:this.chrlatchR=!0,this.setupPPUBanks()}return t}setupPPUBanks(){this.chrlatchL?this.setppubank(4,0,this.chrbankL2):this.setppubank(4,0,this.chrbankL1),this.chrlatchR?this.setppubank(4,4,this.chrbankR2):this.setppubank(4,4,this.chrbankR1)}setppubank(s,t,h){for(let a=0;a<s;++a)this.chr_map[a+t]=1024*(s*h+a)%this.chrsize}}export{n as default};
