import{X as s,t as e}from"./index-C1mDYnUx.js";import{n as r}from"./Mapper-DR43KiVi-C3VBMEhO.js";class u extends r{reg=new Uint8Array(8);prg0=0;prg1=1;we_sram=0;irqEnable=0;irqCounter=0;irqLatch=0;irqRequest=0;irqType=s.IRQ_CLOCK;loadROM(){super.loadROM();for(let t=0;t<8;t++)this.reg[t]=0;const i=this.getPROM8KSize();this.setPROM32KBank4(0,1,i-2,i-1),this.getVROM1KSize()>0&&this.setVROM8KBank(0)}cartWrite(i,t){switch(63487&i){case 32768:return void(this.reg[0]=t);case 32769:switch(this.reg[1]=t,this.reg[0]){case 0:this.reg[3]=(2&t)<<5,this.setPROM8KBank(6,62|this.reg[3]),this.setPROM8KBank(7,63|this.reg[3]);break;case 6:this.prg0=t;break;case 7:this.prg1=t}return this.setPROM8KBank(4,this.prg0|this.reg[3]),void this.setPROM8KBank(5,this.prg1|this.reg[3]);case 40960:return this.reg[2]=t,void(this.scrolltype!==e.FOUR_SCREEN_MIRROR&&(1&t?this.setmirroring(e.H_MIRROR):this.setmirroring(e.V_MIRROR)));case 40961:return;case 49152:return this.reg[4]=t,this.irqCounter=t,this.irqRequest=0,void(this.cpu.interrupt=0);case 49153:return this.reg[5]=t,this.irqLatch=t,this.irqRequest=0,void(this.cpu.interrupt=0);case 57344:return this.reg[6]=t,this.irqEnable=0,this.irqRequest=0,void(this.cpu.interrupt=0);case 57345:return this.reg[7]=t,this.irqEnable=1,this.irqRequest=0,void(this.cpu.interrupt=0)}super.cartWrite(i,t)}notifyscanline(i){i>=0&&i<=239&&this.ppu?.renderingOn()&&this.irqEnable!==0&&this.irqRequest===0&&(i===0&&this.irqCounter!==0&&this.irqCounter--,this.irqCounter--===0&&(this.irqRequest=255,this.irqCounter=this.irqLatch,this.cpu&&this.cpu.interrupt++))}}export{u as default};
