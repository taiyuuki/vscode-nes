import{a as t,r as i}from"./index-C1mDYnUx.js";class h{timers=[new t(16),new t(16)];enable=[!0,!0,!0];volume=[0,0,0];sawdivider=15;sawctr=0;sawaccum=0;sawseq=0;clocknow=!1;write(e,s){switch(e){case 36864:this.volume[0]=15&s,this.timers[0].setduty(s&i.BIT7?16:1+(s>>4&7));break;case 36865:this.timers[0].setperiod((3840&this.timers[0].getperiod())+s);break;case 36866:this.timers[0].setperiod((255&this.timers[0].getperiod())+((15&s)<<8)),this.enable[0]=!!(s&i.BIT7);break;case 40960:this.volume[1]=15&s,this.timers[1].setduty(s&i.BIT7?16:1+(s>>4&7));break;case 40961:this.timers[1].setperiod((3840&this.timers[1].getperiod())+s);break;case 40962:this.timers[1].setperiod((255&this.timers[1].getperiod())+((15&s)<<8)),this.enable[1]=!!(s&i.BIT7);break;case 45056:this.sawaccum=63&s;break;case 45057:this.sawdivider=(3840&this.sawdivider)+s;break;case 45058:this.sawdivider=(255&this.sawdivider)+((15&s)<<8),this.enable[2]=!!(s&i.BIT7)}}clock(e){this.timers[0].clock(e),this.timers[1].clock(e);for(let s=0;s<e;++s)this.clocksaw()}getval(){return 320*((this.enable[0]?this.volume[0]:0)*this.timers[0].getval()+(this.enable[1]?this.volume[1]:0)*this.timers[1].getval()+(this.enable[2]?(255&this.volume[2])>>3:0))}clocksaw(){--this.sawctr,this.sawctr<0&&(this.sawctr=this.sawdivider,this.clocknow?(this.clocknow=!1,this.volume[2]+=this.sawaccum,++this.sawseq,this.sawseq>6&&(this.sawseq=0,this.volume[2]=0)):this.clocknow=!0)}}export{h as t};
