import{t,r as h}from"./index-C1mDYnUx.js";import{n as p}from"./Mapper-DR43KiVi-C3VBMEhO.js";class n extends p{chrbank=[0,0,0,0,0,0,0,0];irqctr=0;irqreload=0;irqenable=!1;interrupted=!1;loadROM(){super.loadROM();for(let i=1;i<=32;++i)this.prg_map[32-i]=this.prgsize-1024*i;for(let i=0;i<8;++i)this.chr_map[i]=1024*i&this.chrsize-1}cartWrite(i,e){if(i<32768||i>53247)super.cartWrite(i,e);else if(i>=32768&&i<=36863)for(let r=0;r<8;++r)this.prg_map[r]=1024*(r+8*e)&this.prgsize-1;else if(i===36865)this.setmirroring((e&h.BIT7)===0?t.V_MIRROR:t.H_MIRROR);else if(i===36867)this.irqenable=(e&h.BIT7)!==0,this.interrupted&&(--this.cpu.interrupt,this.interrupted=!1);else if(i===36868)this.irqctr=this.irqreload,this.interrupted&&(--this.cpu.interrupt,this.interrupted=!1);else if(i===36869)this.irqreload=255&this.irqreload|e<<8;else if(i===36870)this.irqreload=65280&this.irqreload|e;else if(i>=40960&&i<=45055)for(let r=0;r<8;++r)this.prg_map[r+8]=1024*(r+8*e)&this.prgsize-1;else if(i>=45056&&i<=49151)this.chrbank[7&i]=e,this.setppubank(1,7&i,this.chrbank[7&i]);else if(i>=49152&&i<=53247)for(let r=0;r<8;++r)this.prg_map[r+16]=1024*(r+8*e)&this.prgsize-1}cpucycle(i){this.irqenable&&(this.irqctr<=0?(this.interrupted||(++this.cpu.interrupt,this.interrupted=!0),this.irqenable=!1):this.irqctr-=i)}setppubank(i,e,r){for(let s=0;s<i;++s)this.chr_map[s+e]=1024*(r+s)&this.chrsize-1}}export{n as default};
