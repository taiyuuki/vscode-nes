import{t as r}from"./index-C1mDYnUx.js";import{n as t}from"./Mapper-DR43KiVi-C3VBMEhO.js";class c extends t{reg=new Uint8Array(11);irqEnable=0;irqMode=0;irqCounter=65535;irqLatch=65535;loadROM(){super.loadROM();for(let s=0;s<11;++s)this.reg[s]=0;this.reg[2]=this.getPROM8KSize()-2,this.reg[3]=this.getPROM8KSize()-1,this.setPROM32KBank4(0,1,this.reg[2],this.reg[3])}cartWrite(s,e){switch(s){case 32768:this.reg[0]=240&this.reg[0]|15&e,this.setPROM8KBank(4,this.reg[0]);break;case 32769:this.reg[0]=15&this.reg[0]|(15&e)<<4,this.setPROM8KBank(4,this.reg[0]);break;case 32770:this.reg[1]=240&this.reg[1]|15&e,this.setPROM8KBank(5,this.reg[1]);break;case 32771:this.reg[1]=15&this.reg[1]|(15&e)<<4,this.setPROM8KBank(5,this.reg[1]);break;case 36864:this.reg[2]=240&this.reg[2]|15&e,this.setPROM8KBank(6,this.reg[2]);break;case 36865:this.reg[2]=15&this.reg[2]|(15&e)<<4,this.setPROM8KBank(6,this.reg[2]);break;case 40960:this.reg[3]=240&this.reg[3]|15&e,this.setVROM1KBank(0,this.reg[3]);break;case 40961:this.reg[3]=15&this.reg[3]|(15&e)<<4,this.setVROM1KBank(0,this.reg[3]);break;case 40962:this.reg[4]=240&this.reg[4]|15&e,this.setVROM1KBank(1,this.reg[4]);break;case 40963:this.reg[4]=15&this.reg[4]|(15&e)<<4,this.setVROM1KBank(1,this.reg[4]);break;case 45056:this.reg[5]=240&this.reg[5]|15&e,this.setVROM1KBank(2,this.reg[5]);break;case 45057:this.reg[5]=15&this.reg[5]|(15&e)<<4,this.setVROM1KBank(2,this.reg[5]);break;case 45058:this.reg[6]=240&this.reg[6]|15&e,this.setVROM1KBank(3,this.reg[6]);break;case 45059:this.reg[6]=15&this.reg[6]|(15&e)<<4,this.setVROM1KBank(3,this.reg[6]);break;case 49152:this.reg[7]=240&this.reg[7]|15&e,this.setVROM1KBank(4,this.reg[7]);break;case 49153:this.reg[7]=15&this.reg[7]|(15&e)<<4,this.setVROM1KBank(4,this.reg[7]);break;case 49154:this.reg[8]=240&this.reg[8]|15&e,this.setVROM1KBank(5,this.reg[8]);break;case 49155:this.reg[8]=15&this.reg[8]|(15&e)<<4,this.setVROM1KBank(5,this.reg[8]);break;case 53248:this.reg[9]=240&this.reg[9]|15&e,this.setVROM1KBank(6,this.reg[9]);break;case 53249:this.reg[9]=15&this.reg[9]|(15&e)<<4,this.setVROM1KBank(6,this.reg[9]);break;case 53250:this.reg[10]=240&this.reg[10]|15&e,this.setVROM1KBank(7,this.reg[10]);break;case 53251:this.reg[10]=15&this.reg[10]|(15&e)<<4,this.setVROM1KBank(7,this.reg[10]);break;case 57344:this.irqLatch=65520&this.irqLatch|15&e;break;case 57345:this.irqLatch=65295&this.irqLatch|(15&e)<<4;break;case 57346:this.irqLatch=61695&this.irqLatch|(15&e)<<8;break;case 57347:this.irqLatch=4095&this.irqLatch|(15&e)<<12;break;case 61440:this.irqCounter=this.irqLatch;break;case 61441:this.irqMode=e>>1&7,this.irqEnable=1&e,this.cpu.interrupt=0;break;case 61442:(e&=3)===0?this.setmirroring(r.H_MIRROR):e===1?this.setmirroring(r.V_MIRROR):this.setmirroring(r.FOUR_SCREEN_MIRROR)}}cpucycle(s){let e=!1;const i=this.irqCounter;if(this.irqEnable&&this.irqCounter!==0){switch(this.irqCounter-=s,this.irqMode){case 0:e=!0;break;case 1:(61440&this.irqCounter)!=(61440&i)&&(e=!0);break;case 2:case 3:(65280&this.irqCounter)!=(65280&i)&&(e=!0);break;case 4:case 5:case 6:case 7:(65520&this.irqCounter)!=(65520&i)&&(e=!0)}e&&(this.irqCounter=0,this.irqEnable=0,this.cpu.interrupt++)}}}export{c as default};
