import{t as p}from"./index-C1mDYnUx.js";import{n as h}from"./Mapper-DR43KiVi-C3VBMEhO.js";class c extends h{prgbank0=0;prgbank1=0;chrbank=[0,0,0,0,0,0,0,0];loadROM(){super.loadROM();for(let r=1;r<=32;++r)this.prg_map[32-r]=this.prgsize-1024*r;for(let r=0;r<8;++r)this.chr_map[r]=1024*r&this.chrsize-1}cartWrite(r,t){if(r<32768||r>65535)return void super.cartWrite(r,t);const e=!!(2&r),a=!!(1&r);switch(r>>12){case 8:this.prgbank0=15&t;break;case 9:switch(1&t){case 0:this.setmirroring(p.V_MIRROR);break;case 1:this.setmirroring(p.H_MIRROR)}break;case 10:this.prgbank1=15&t;break;case 11:case 12:case 13:case 14:t&=15;const i=(r-45056>>11)+(a?1:0);let s=this.chrbank[i];e?(s&=15,s|=t<<4):(s&=240,s|=t),this.chrbank[i]=s}r<61440&&this.setbanks()}setbanks(){for(let r=1;r<=16;++r)this.prg_map[32-r]=this.prgsize-1024*r;for(let r=0;r<8;++r)this.prg_map[r]=1024*(r+8*this.prgbank0)%this.prgsize;for(let r=0;r<8;++r)this.prg_map[r+8]=1024*(r+8*this.prgbank1)%this.prgsize;for(let r=0;r<8;++r)this.setppubank(1,r,this.chrbank[r]>>1)}setppubank(r,t,e){for(let a=0;a<r;++a)this.chr_map[a+t]=1024*(e+a)%this.chrsize}getMapperState(){return{...super.getMapperState(),prgbank0:this.prgbank0,prgbank1:this.prgbank1,chrbank:[...this.chrbank]}}setMapperState(r){super.setMapperState(r),r.prgbank0!==void 0&&(this.prgbank0=r.prgbank0),r.prgbank1!==void 0&&(this.prgbank1=r.prgbank1),r.chrbank&&(this.chrbank=[...r.chrbank])}}export{c as default};
