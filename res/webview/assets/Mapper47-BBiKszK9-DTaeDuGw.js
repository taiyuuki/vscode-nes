import{r as e,t as s}from"./index-C1mDYnUx.js";import a from"./MMC3Mapper-C80ixlo9-C15TrJWb.js";import"./Mapper-DR43KiVi-C3VBMEhO.js";class m extends a{multibank=1;loadROM(){super.loadROM();for(let t=1;t<=32;++t)this.prg_map[32-t]=this.prgsize-1024*t;for(let t=0;t<8;++t)this.chr_map[t]=0;this.setbank6()}cartWrite(t,r){if(t<24576||t>65535)super.cartWrite(t,r);else{if(t>=24576&&t<=32767){this.multibank=1&r;for(let i=0;i<8;++i)this.prg_map[i+8]=1024*(i+8*r)%131072+131072*this.multibank;this.setbank6(),this.setupchr();for(let i=1;i<=8;++i)this.prg_map[32-i]=131072-1024*i+131072*this.multibank}if((t&e.BIT0)===0)t>=32768&&t<=40959?(this.whichbank=7&r,this.prgconfig=(r&e.BIT6)!==0,this.chrconfig=(r&e.BIT7)!==0,this.setupchr(),this.setbank6()):t>=40960&&t<=49151?this.scrolltype!==s.FOUR_SCREEN_MIRROR&&this.setmirroring((r&e.BIT0)===0?s.V_MIRROR:s.H_MIRROR):t>=49152&&t<=57343?this.irqctrreload=r:t>=57344&&t<=65535&&(this.interrupted&&--this.cpu.interrupt,this.interrupted=!1,this.irqenable=!1);else if(t>=32768&&t<=40959){if(this.whichbank<=5)this.chrreg[this.whichbank]=r,this.setupchr();else if(this.whichbank===6)this.bank6=r,this.setbank6();else if(this.whichbank===7)for(let i=0;i<8;++i)this.prg_map[i+8]=1024*(i+8*r)%131072+131072*this.multibank}else t>=40960&&t<=49151||(t>=49152&&t<=57343?this.irqreload=!0:t>=57344&&t<=65535&&(this.irqenable=!0))}}setbank6(){if(this.prgconfig)for(let t=0;t<8;++t)this.prg_map[t]=114688+1024*(t+128*this.multibank),this.prg_map[t+16]=1024*(t+8*this.bank6)%131072+131072*this.multibank;else for(let t=0;t<8;++t)this.prg_map[t]=1024*(t+8*this.bank6)%131072+131072*this.multibank,this.prg_map[t+16]=114688+1024*(t+128*this.multibank)}setppubank(t,r,i){for(let h=0;h<t;++h)this.chr_map[h+r]=1024*(i+h)%(this.chrsize/2)+131072*this.multibank}}export{m as default};
