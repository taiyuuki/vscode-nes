import{n as e}from"./Mapper-DR43KiVi-C3VBMEhO.js";import"./index-C1mDYnUx.js";class l extends e{irqctr=0;irqreload=0;irqmode=!1;irqenable=!1;irqackenable=!1;interrupted=!1;loadROM(){super.loadROM();for(let r=0;r<16;++r)this.prg_map[r]=1024*r&this.prgsize-1;for(let r=1;r<=16;++r)this.prg_map[32-r]=this.prgsize-1024*r;for(let r=0;r<8;++r)this.chr_map[r]=1024*r&this.chrsize-1}cartWrite(r,i){if(r<32768||r>65535)super.cartWrite(r,i);else switch(r>>12){case 8:this.irqreload=65520&this.irqreload|15&i;break;case 9:this.irqreload=65295&this.irqreload|(15&i)<<4;break;case 10:this.irqreload=61695&this.irqreload|(15&i)<<8;break;case 11:this.irqreload=4095&this.irqreload|(15&i)<<12;break;case 12:this.irqmode=!!(4&i),this.irqackenable=!!(1&i),this.irqenable=!!(2&i),this.irqenable&&(this.irqmode?(this.irqctr&=65280,this.irqctr|=255&this.irqreload):this.irqctr=this.irqreload,this.interrupted&&(--this.cpu.interrupt,this.interrupted=!1));break;case 13:this.irqenable=this.irqackenable,this.interrupted&&(--this.cpu.interrupt,this.interrupted=!1);break;case 15:for(let t=0;t<16;++t)this.prg_map[t]=1024*(t+16*(15&i))&this.prgsize-1}}cpucycle(r){if(this.irqenable)if(this.irqmode){let i=this.irqctr;this.irqctr&=65280,i>=255?(this.irqctr=this.irqreload,this.irqctr|=255&this.irqreload,this.interrupted||(++this.cpu.interrupt,this.interrupted=!0)):(i+=r,this.irqctr|=i)}else this.irqctr>=65535?(this.irqctr=this.irqreload,this.interrupted||(++this.cpu.interrupt,this.interrupted=!0)):this.irqctr+=r}}export{l as default};
