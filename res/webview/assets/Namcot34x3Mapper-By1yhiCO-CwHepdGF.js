import{t as i}from"./index-C1mDYnUx.js";import{n as e}from"./Mapper-DR43KiVi-C3VBMEhO.js";class n extends e{mirroring=!1;whichbank=0;chrreg=[0,0,0,0,0,0];constructor(r){super(r),this.mirroring=r.mappertype===154}loadROM(){super.loadROM();for(let r=1;r<=32;++r)this.prg_map[32-r]=this.prgsize-1024*r;for(let r=0;r<8;++r)this.chr_map[r]=0}cartWrite(r,h){if(r<32768||r>65535)super.cartWrite(r,h);else{if(r===32769){if(this.whichbank<=5)this.chrreg[this.whichbank]=63&h,this.setupchr();else if(this.whichbank===6)for(let t=0;t<8;++t)this.prg_map[t]=1024*(t+8*h)%this.prgsize;else if(this.whichbank===7)for(let t=0;t<8;++t)this.prg_map[t+8]=1024*(t+8*h)%this.prgsize}else r===32768&&(this.whichbank=7&h);this.mirroring&&this.setmirroring(64&h?i.SS_MIRROR1:i.SS_MIRROR0)}}setupchr(){this.setppubank(1,4,64|this.chrreg[2]),this.setppubank(1,5,64|this.chrreg[3]),this.setppubank(1,6,64|this.chrreg[4]),this.setppubank(1,7,64|this.chrreg[5]),this.setppubank(2,0,this.chrreg[0]>>1<<1),this.setppubank(2,2,this.chrreg[1]>>1<<1)}setppubank(r,h,t){for(let s=0;s<r;++s)this.chr_map[s+h]=1024*(t+s)%this.chrsize}}export{n as default};
