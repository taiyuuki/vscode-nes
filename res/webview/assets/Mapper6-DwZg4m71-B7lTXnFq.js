import{n as s}from"./Mapper-DR43KiVi-C3VBMEhO.js";import"./index-C1mDYnUx.js";class n extends s{irqEnable=0;irqCounter=0;constructor(t){super(t)}reset(){this.setPROM32KBank4(0,1,14,15),this.getVROM1KSize(),this.setVROM8KBank(0),this.irqEnable=0,this.irqCounter=0}cartWrite(t,i){t>=16416&&t<24576?this.writeLow(t,i):t>=32768?this.write(t,i):super.cartWrite(t,i)}writeLow(t,i){switch(t){case 17150:16&i?this.setVRAMMirror(4):this.setVRAMMirror(3);break;case 17151:16&i?this.setVRAMMirror(0):this.setVRAMMirror(1);break;case 17665:this.irqEnable=0,this.cpu&&(this.cpu.interrupt&=-5);break;case 17666:this.irqCounter=65280&this.irqCounter|i;break;case 17667:this.irqCounter=255&this.irqCounter|i<<8,this.irqEnable=255,this.cpu&&(this.cpu.interrupt&=-5);break;default:super.cartWrite(t,i)}}write(t,i){if(this.setPROM16KBank(4,(60&i)>>2),this.haschrram){const r=3&i;this.setVROM8KBank(r)}}notifyscanline(t){this.irqEnable!==0&&(this.irqCounter+=133,this.irqCounter>=65535&&(this.irqCounter=0,this.cpu&&(this.cpu.interrupt|=4)))}postLoadState(t){this.irqEnable===0&&this.cpu&&(this.cpu.interrupt&=-5)}}export{n as default};
